# ⚽ footy-predictions — Клуб им. А.Н. Мурашева

Веб-приложение для футбольного “тотализатора”: участники оставляют прогнозы на матчи, после внесения результата автоматически начисляются очки и обновляются таблицы/аналитика.

Репозиторий: Next.js + Supabase (Postgres) + RLS + SQL-функции начисления.

---

## Возможности

### Для участников
- Прогноз на матч (до дедлайна).
- Текущая таблица этапа с очками по каждому матчу.
- Расшифровка начисления (поп-овер): исход, разница, голы, промах на 1 мяч, множители и т.д.
- Аналитика по этапу: качество угадываний, очки/матч, форма, график динамики очков.

### Для админа
- Управление этапами/турами/командами/матчами.
- Внесение результата матча и моментальный пересчёт начислений.
- Аудит действий.
- Тест-кнопка Telegram-напоминаний (если включено).

---

## Технологии

- **Next.js (App Router) + TypeScript**
- **Supabase**:
  - Postgres
  - Row Level Security (RLS)
  - RPC (SQL-функции)
- Развёртывание: Vercel (или любой Node-хостинг)
- Telegram-бот (опционально): напоминания о незаполненных прогнозах

---

## Архитектура (коротко)

- Данные матча и прогнозов живут в Postgres.
- Начисления пишутся в `points_ledger`.
- Пересчёт выполняется SQL-функцией (`recalculate_match` / `score_match`).
- В админском API при сохранении счёта:
  1) матч помечается `status = 'finished'` (если задан счёт)
  2) вызывается RPC пересчёта, чтобы очки появились сразу

---

## Быстрый старт (локально)

### 1) Установка
```bash
npm install